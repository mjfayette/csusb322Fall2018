<!DOCTYPE html>
<html>
  <head>
    <title> Platform</title>
    <canvas id="canvas" style="border:1px solid #000"></canvas>
  </head>
  <body>
  <script>
      (function() {
        var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
        window.requestAnimationFrame = requestAnimationFrame;
      })();
 
      var canvas = document.getElementById("canvas"),
        ctx = canvas.getContext("2d"),
        width = 500,
        height = 200,
        player = {
          x : width/2,
          y : height - 5,
          width : 5,
          height : 5,
          speed: 3,
          velX: 0,
          velY: 0,
          jumping: false
        },
        keys = [],
        friction = 0.8,
        gravity = 0.2;
    
      var boxes = [];
      // dimensions
      boxes.push({
          x: 0,
          y: 0,
          width: 10,
          height: height
      });
      boxes.push({
          x: 0,
          y: height - 2,
          width: width,
          height: 50
      });
      boxes.push({
          x: width - 10,
          y: 0,
          width: 50,
          height: height
      });

      boxes.push({
          x: 120,
          y: 10,
          width: 80,
          height: 80
      });
      boxes.push({
          x: 170,
          y: 50,
          width: 80,
          height: 80
      });
      boxes.push({
          x: 220,
          y: 100,
          width: 80,
          height: 80
      });
      boxes.push({
          x: 270,
          y: 150,
          width: 40,
          height: 40
      });
 
    canvas.width = width;
    canvas.height = height;
 
    function update(){
      // check keys
        if (keys[38] || keys[32]) {
            // up arrow or space
          if(!player.jumping){
            player.jumping = true;
            player.velY = -player.speed*2;
          }
        }
        if (keys[39]) {
            // right arrow
            if (player.velX < player.speed) {             
                player.velX++;         
            }     
        }     
        if (keys[37]) {         
            // left arrow         
            if (player.velX > -player.speed) {
                player.velX--;
            }
        }
 
        player.velX *= friction;
 
        player.velY += gravity;
 
        player.x += player.velX;
        player.y += player.velY;
      
        ctx.clearRect(0, 0, width, height);
        ctx.fillStyle = "black";
        ctx.beginPath();
 
        if (player.x >= width-player.width) {
            player.x = width-player.width;
        } else if (player.x <= 0) {         
            player.x = 0;     
        }    
  
        if(player.y >= height-player.height){
            player.y = height - player.height;
            player.jumping = false;
        }
 
      ctx.clearRect(0,0,width,height);
      ctx.fillStyle = "red";
      ctx.fillRect(player.x, player.y, player.width, player.height)
 
      requestAnimationFrame(update);
    }
 
    document.body.addEventListener("keydown", function(e) {
        keys[e.keyCode] = true;
    });
 
    document.body.addEventListener("keyup", function(e) {
        keys[e.keyCode] = false;
    });
 
    window.addEventListener("load",function(){
        update();
    });
  </script>
  </body>
</html>
